<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details | Vandals Fashion</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #fffaf5;
      margin: 0;
    }

    header {
      background: white;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    header h1 {
      font-size: 1.4rem;
      color: #c39a6b;
    }

    .nav-links {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .nav-links a {
      text-decoration: none;
      color: #444;
      font-weight: 500;
    }

    #profilePic {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
    }

    #userDropdown {
      display: none;
      position: absolute;
      top: 60px;
      right: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    #userDropdown a {
      display: block;
      padding: 0.75rem 1rem;
      text-decoration: none;
      color: #333;
    }

    .container {
      max-width: 1100px;
      margin: 2rem auto;
      padding: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
    }

    img {
      width: 100%;
      max-width: 450px;
      border-radius: 12px;
    }

    .details {
      flex: 1;
      min-width: 280px;
    }

    h2 {
      font-size: 1.8rem;
      color: #c39a6b;
      margin-bottom: 0.5rem;
    }

    .note {
      background: #fff1e8;
      padding: 1rem;
      border-radius: 12px;
      margin: 1rem 0;
      font-size: 0.95rem;
    }

    .sizes, .custom-size {
      margin-top: 1.2rem;
    }

    label {
      display: block;
      margin: 0.5rem 0;
      font-weight: 500;
    }

    select, input[type="text"] {
      width: 100%;
      padding: 0.6rem;
      border-radius: 10px;
      border: 1px solid #ccc;
    }

    button {
      margin-top: 1.5rem;
      padding: 0.8rem 2rem;
      background: black;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
    }

    button:hover {
      background: #333;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        padding: 1rem;
      }
    }
  </style>
</head>
<body>

  <!-- ðŸ” HEADER -->
  <header>
    <h1>Vandals Fashion</h1>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="shop.html">Shop</a>
      <a href="cart.html">Cart</a>
      <img id="profilePic" src="" alt="Profile" style="display:none;" />
      <a id="authLink" href="auth.html">Login</a>
      <div id="userDropdown">
        <a href="account.html">Manage Account</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </div>
  </header>

  <!-- ðŸ§¥ PRODUCT DETAIL -->
  <div class="container">
    <div>
      <img id="productImage" src="" alt="Product" />
    </div>
    <div class="details">
      <h2 id="productName"></h2>
      <p id="productPrice"></p>
      <p class="note">Estimated delivery: 15â€“20 days. International orders may take an additional 15â€“20 days.</p>

      <div class="sizes">
        <label for="sizeSelect">Choose Size:</label>
        <select id="sizeSelect">
          <option value="M">M (Waist 17â€“18", Hip 21â€“22", Chest 20")</option>
          <option value="L">L</option>
          <option value="XL">XL</option>
          <option value="XXL">XXL</option>
          <option value="custom">Custom Size</option>
        </select>
      </div>

      <div class="custom-size" id="customSizeFields" style="display:none;">
        <label>Waist (inches): <input type="text" id="waist" /></label>
        <label>Hip (inches): <input type="text" id="hip" /></label>
        <label>Chest (inches): <input type="text" id="chest" /></label>
      </div>

      <label for="colorChange">Color Preference (if different):</label>
      <input type="text" id="colorChange" placeholder="e.g., pastel pink" />

      <button onclick="placeOrder()">Place Order</button>
    </div>
  </div>

  <!-- ðŸ”— SCRIPTS -->
  <script type="module">
    import { auth, db } from './firebase-config.js';
    import { doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';
    import { onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js';

    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");

    const productDoc = await getDoc(doc(db, "products", productId));
    const product = productDoc.data();

    document.getElementById("productImage").src = product.imageUrl;
    document.getElementById("productName").textContent = product.name;
    document.getElementById("productPrice").textContent = `Price: â‚¹${product.price}`;

    const sizeSelect = document.getElementById("sizeSelect");
    sizeSelect.addEventListener("change", () => {
      document.getElementById("customSizeFields").style.display = sizeSelect.value === "custom" ? "block" : "none";
    });

    window.placeOrder = function () {
      const size = sizeSelect.value;
      const customSizes = size === "custom" ? {
        waist: document.getElementById("waist").value,
        hip: document.getElementById("hip").value,
        chest: document.getElementById("chest").value
      } : null;
      const color = document.getElementById("colorChange").value;

      console.log("Order placed with:", {
        product: product.name,
        price: product.price,
        size,
        customSizes,
        color
      });

      alert("Your order has been initiated!");
    };

    // Top-right profile
    const profilePic = document.getElementById("profilePic");
    const authLink = document.getElementById("authLink");
    const userDropdown = document.getElementById("userDropdown");

    onAuthStateChanged(auth, (user) => {
      if (user && user.photoURL) {
        profilePic.src = user.photoURL;
        profilePic.style.display = "inline-block";
        authLink.style.display = "none";
      }
    });

    profilePic?.addEventListener("click", () => {
      userDropdown.style.display = userDropdown.style.display === "block" ? "none" : "block";
    });

    window.logout = () => {
      signOut(auth).then(() => {
        window.location.href = "auth.html";
      });
    };
  </script>
</body>
</html>
